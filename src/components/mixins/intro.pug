//- Миксин для фона intro секции
//- @param {string} mediaType - тип медиа: 'image', 'video', 'iframe' (по умолчанию 'image')
//- @param {string|array} mediaSrc - источник медиа (путь к изображению, видео или URL для iframe). Для video можно передать массив объектов [{src: 'path.mp4', type: 'video/mp4'}, {src: 'path.webm', type: 'video/webm'}]
//- @param {string} mediaAlt - альтернативный текст для изображения (по умолчанию 'intro bg')
//- @param {object} videoAttrs - дополнительные атрибуты для тега video (autoplay, loop, muted, playsinline и т.д.)
//- @param {boolean} overlay - показывать ли оверлей (по умолчанию true)
//- @param {string} img - устаревший параметр, используйте mediaSrc (поддерживается для обратной совместимости)
mixin IntroBg(props)
  - const {mediaType, mediaSrc = '', mediaAlt = 'intro bg', videoAttrs = {}, overlay = true, img = ''} = props
  - const finalMediaType = mediaType || (img ? 'image' : 'image')
  - const finalMediaSrc = mediaSrc || img
  - const defaultVideoAttrs = {autoplay: true, loop: true, muted: true, playsinline: true, ...videoAttrs}
  - const isVideoSourcesArray = Array.isArray(finalMediaSrc)
  .intro_bg
    .intro_bg_img
      if finalMediaType === 'image'
        if finalMediaSrc
          img(src=finalMediaSrc, alt=mediaAlt)
      else if finalMediaType === 'video'
        video&attributes(defaultVideoAttrs)
          if isVideoSourcesArray
            each source in finalMediaSrc
              source(src=source.src, type=source.type)
          else
            source(src=finalMediaSrc, type="video/mp4")
          | Ваш браузер не поддерживает видео.
      else if finalMediaType === 'iframe'
        iframe(src=finalMediaSrc, frameborder="0", allow="autoplay; encrypted-media", allowfullscreen)
    if overlay
      .intro_bg_overlay.intro_bg_overlay--radial
      .intro_bg_overlay.intro_bg_overlay--fill

//- Миксин для интро секции с видео фоном
//- @param {string} videoSrc - URL видео для фона (iframe)
//- @param {string} title - заголовок
//- @param {string} description - описание (опционально)
//- @param {array} breadcrumbs - массив хлебных крошек (опционально)
//- @param {array} features - массив преимуществ [{label: '', value: ''}] (опционально)
//- @param {array} buttons - массив кнопок [{text: '', styles: []}] (опционально)
//- @param {boolean} showLogo - показывать ли логотип (по умолчанию true)
mixin IntroVideo(props)
  - const {videoSrc = '', title = '', description = '', breadcrumbs = [], features = [], buttons = [], showLogo = true} = props
  section.intro.intro--banya
    +IntroBg({mediaType: 'iframe', mediaSrc: videoSrc})
    .container.intro_container
      if breadcrumbs && breadcrumbs.length > 0
        .intro_footer
          .intro_footer_left
            +BreadCrumbs({items: breadcrumbs})
      .intro_content
        if showLogo
          .intro_logo
            +Logo({type: 'intro'})
        .intro_title
          h1.title.title-h1.intro_title-h1!= title
        if description
          .intro_description
            p!= description
        if features && features.length > 0
          .intro_features
            .intro_features_list
              each feature in features
                .intro_features_item
                  if feature.label && feature.label !== ''
                    span.intro_features_label= feature.label + ':'
                  if feature.value && feature.value !== ''
                    span.intro_features_value= feature.value
        if buttons && buttons.length > 0
          .intro_actions
            .intro_actions-group
              each button in buttons
                +Button(button.text, button.styles)

//- Миксин для коротких intro секций (404, about, blog, contacts, privacy, reviews, remont)
//- @param {string} bgImg - путь к фоновому изображению
//- @param {string|object} title - заголовок (может быть строкой или объектом с html)
//- @param {array} breadcrumbs - массив элементов breadcrumbs
//- @param {string} sectionClass - класс модификатор для section (по умолчанию 'intro--alt')
mixin IntroShort(props)
  - const {bgImg = '', title = '', breadcrumbs = [], sectionClass = 'intro--alt'} = props
  section.intro(class=sectionClass)
    +IntroBg({mediaType: 'image', mediaSrc: bgImg})
    .container.intro_container
      .intro_content
        .intro_title
          h1.title.title-h1!= title
      .intro_footer
        .intro_footer_left
          +BreadCrumbs({items: breadcrumbs})

mixin Intro(props)
  - const {title = '', breadcrumbs = [], type = 'secondary'} = props
  section.section.section--intro(class=`intro--${type}`)
    .container.section_container
      .section_content
        .section_title
          h1.title.title-h1!= title
          +BreadCrumbs({items: breadcrumbs})

//- Миксин для полных intro секций (main, post, catalog)
//- @param {string} bgImg - путь к фоновому изображению
//- @param {string} sectionClass - класс модификатор для section (по умолчанию 'intro')
//- @param {object} content - объект с контентом (logo, text, button, socials, title, postInfo, description, cards, breadcrumbs)
mixin IntroFull(props)
  - const {bgImg = '', sectionClass = 'intro', content = {}} = props
  section.intro(class=sectionClass)
    +IntroBg({mediaType: 'image', mediaSrc: bgImg})
    .container.intro_container
      .intro_content(class=content.contentClass || '')
        if content.logo
          .intro_logo
            +Logo({type: content.logoType || 'intro'})(class='logo--intro')
        if content.text
          .intro_text
            p!= content.text
        if content.title
          .intro_title
            h1.title.title-h1!= content.title
        if content.description
          p!= content.description
        if content.postInfo
          .intro_info
            .post_info
              each item in content.postInfo
                .post_info-item
                  .post_info-item_icon(class=`post_info-item_icon--${item.icon}`)
                  p.post_info-item_label= item.label
        if content.cards
          .intro_cards
            each card in content.cards
              .intro_card
                .intro_card_title
                  span.title.title-h3!= card.title
                .intro_card_text
                  p!= card.text
        if content.button
          .intro_actions
            - const buttonClasses = content.button.classes || ['primary', 'sm']
            - const buttonStyles = buttonClasses.map(cls => cls === 'glass' ? 'primary' : cls === 'outlined' ? 'secondary' : cls === 'default' ? 'primary' : cls)
            +Button(content.button.text, buttonStyles)(data-modal=content.button.modal data-modal-action="toggle")
        if content.breadcrumbs
          +BreadCrumbs({items: content.breadcrumbs})

//- Миксин для интро секций с опциональным лейблом над заголовком
//- @param {string} bgImg - путь к фоновому изображению (обязательный)
//- @param {string} title - основной заголовок (обязательный)
//- @param {string} label - текст над заголовком (опциональный, показывается только если передан)
mixin IntroLabeled(props)
  - const {bgImg, title, label} = props || {}
  - if (!bgImg) throw new Error('IntroLabeled: bgImg is required')
  - if (!title) throw new Error('IntroLabeled: title is required')
  section.intro.intro--labeled
    +IntroBg({mediaType: 'image', mediaSrc: bgImg})
    .container.intro_container
      .intro_content
        if label
          .intro_label= label
        .intro_title
          h1.title.title-h1!= title
      .intro_footer
        a.intro_arrow(href="#next-section", aria-label="Перейти к следующей секции")
          svg.intro_arrow-icon(width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg")
            path(d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round")